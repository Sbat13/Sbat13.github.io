---
title: "DC.js + Crossfilter Example"
format: html
---

## Interactive Dashboard

This example shows how to build an interactive dashboard with **dc.js** and **crossfilter.js** right inside a Quarto page.

::::: dashboard
::: chart-container
```{=html}
<h3>Distribution by Year</h3>
<div id="chart-ring-year"></div>
```
:::

::: chart-container
```{=html}
<h3>Speed Counts</h3>
<div id="chart-bar-speed"></div>
```
:::
:::::

:::: table-container
```{=html}
<h3>Data Table</h3>
```
::: {#data-table}
:::
::::


```{=html}
<style>
.dashboard {
  display: grid;
  grid-template-columns: 1fr 1fr; /* two equal-width columns */
  gap: 2rem;                     /* space between charts */
  align-items: start;
}

.chart-container {
  text-align: center;            /* centers the chart title */
}
.chart-container {
  text-align: center;
}

.table-container {
  margin-top: 2rem;
}

#data-table table {
  width: 100%;
  border-collapse: collapse;
}

#data-table th, #data-table td {
  border: 1px solid #ddd;
  padding: 6px 12px;
}

#data-table th {
  background-color: #f2f2f2;
  text-align: left;
}
</style>
```

```{=html}
<script src="https://d3js.org/d3.v5.min.js"></script>
```

```{=html}
<script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter2/1.5.4/crossfilter.min.js"></script>
```

```{=html}
<script src="https://cdnjs.cloudflare.com/ajax/libs/dc/4.2.4/dc.min.js"></script>
```

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dc/4.2.4/style/dc.min.css"/>

```{=html}
<script>
// Example dataset
const data = [
  {year: 2020, speed: 30},
  {year: 2020, speed: 35},
  {year: 2021, speed: 40},
  {year: 2021, speed: 45},
  {year: 2022, speed: 50},
  {year: 2022, speed: 55},
  {year: 2023, speed: 60},
  {year: 2023, speed: 65}
];

// Initialize crossfilter
const ndx = crossfilter(data);

// Define dimensions
const yearDim = ndx.dimension(d => d.year);
const speedDim = ndx.dimension(d => d.speed);

// Define groups
const yearGroup = yearDim.group();
const speedGroup = speedDim.group().reduceCount();

// Create charts
const ringChart = dc.pieChart("#chart-ring-year");
ringChart
  .width(200)
  .height(200)
  .radius(90)
  .dimension(yearDim)
  .group(yearGroup)
  .legend(dc.legend());

const barChart = dc.barChart("#chart-bar-speed");
barChart
  .width(400)
  .height(200)
  .dimension(speedDim)
  .group(speedGroup)
  .x(d3.scaleLinear().domain([25,70]))
  .xUnits(dc.units.fp.precision(5))
  .elasticY(true)
  .brushOn(true);

// Data table
const dataTable = dc.dataTable("#data-table");
dataTable
  .dimension(speedDim)
  .group(d => "All Records")
  .size(100)
  .columns([
    d => d.year,
    d => d.speed
  ])
  .sortBy(d => d.year)
  .order(d3.ascending);
  
// Render all charts
dc.renderAll();
</script>
```